<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>Objet 3D sur cam√©ra</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    background: #000;
  }

  video {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    object-fit: cover;
    z-index: 1;
  }

  canvas {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 2;
    display: none;
  }

  /* Logo fixe en bas */
  #logo-bottom {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%) scale(1);
    z-index: 3;
    transition: all 3s ease;
  }

  #logo-bottom img {
    height: 60px;
    width: auto;
    filter: drop-shadow(0 0 20px cyan);
  }

  /* Animation du logo (pr√©load) */
  #logo-bottom.animate {
    bottom: 45%;
    transform: translateX(-50%) scale(2);
  }

</style>
</head>
<body>

<video id="camera" autoplay playsinline></video>
<div id="logo-bottom"><img src="LogoAr.png" alt="Logo Bas"></div>

<script type="module">
import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js';
import { GLTFLoader } from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/loaders/GLTFLoader.js';
import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/controls/OrbitControls.js';

const video = document.getElementById('camera');
const logo = document.getElementById('logo-bottom');
let renderer, scene, camera, model;

// === 1. D√©marre la cam√©ra ===
async function startCamera() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: { ideal: "environment" } },
      audio: false
    });
    video.srcObject = stream;
  } catch (err) {
    console.error("Erreur cam√©ra :", err);
  }
}
startCamera();

// === 2. Animation du logo (pr√©load) ===
setTimeout(() => logo.classList.add('animate'), 100);
setTimeout(() => {
  logo.classList.remove('animate');
  initScene();
}, 3100);

// === 3. Cr√©er la sc√®ne Three.js ===
function initScene() {
  scene = new THREE.Scene();
  camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 100);
  camera.position.set(0, 1, 3);

  renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.domElement.style.display = 'block';
  document.body.appendChild(renderer.domElement);

  // Lumi√®res
  scene.add(new THREE.AmbientLight(0xffffff, 0.8));
  const light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(2, 4, 5);
  scene.add(light);

  // === 4. Charger ton objet 3D ici ===
  const loader = new GLTFLoader();
  const modelURL = "ready_player_me_harry_potter.glb"; // üîπ Remplace par ton lien .glb/.gltf
  loader.load(modelURL, (gltf) => {
    model = gltf.scene;
    model.scale.set(1.2, 1.2, 1.2);
    model.position.set(0, 0, 0);
    scene.add(model);
  });

  // === 5. Contr√¥les tactiles ===
  const controls = new OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true;
  controls.enableZoom = true;
  controls.enablePan = true;
  controls.target.set(0, 0.5, 0);

  // === 6. Boucle d'animation ===
  function animate() {
    requestAnimationFrame(animate);
    controls.update();
    renderer.render(scene, camera);
  }
  animate();

  // === 7. Redimensionner ===
  window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });
}
</script>
</body>
</html>
