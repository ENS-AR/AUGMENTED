<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>AR Boutons interactifs</title>
<style>
  html, body {
    margin: 0;
    height: 100%;
    overflow: hidden;
    background: #000;
    touch-action: none;
    font-family: sans-serif;
  }

  video {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    object-fit: cover;
    z-index: 1;
  }

  canvas {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 2;
    display: none; /* caché jusqu'au clic */
  }

  /* Logo preload en haut */
  #logo-preload {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%) scale(0);
    transition: transform 3s ease;
    z-index: 3;
  }
  #logo-preload.show {
    transform: translateX(-50%) scale(0.7); /* taille moyenne */
  }
  #logo-preload img {
    height: 50px;
    width: auto;
  }

  /* Logo fixe en bas */
  #logo-bottom {
    position: fixed;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 3;
  }
  #logo-bottom img {
    height: 30px;
    width: auto;
  }

  /* Buttons interactifs */
  .ar-button {
    position: absolute;
    background: rgba(0,255,255,0.8);
    color: #000;
    padding: 10px 20px;
    border-radius: 8px;
    cursor: pointer;
    z-index: 4;
    user-select: none;
    touch-action: none;
  }
</style>
</head>
<body>

<video id="camera" autoplay playsinline></video>

<!-- Logo preload en haut -->
<div id="logo-preload"><img src="LogoAR.png" alt="Logo Preload"></div>

<!-- Logo fixe en bas -->
<div id="logo-bottom"><img src="LogoAR.png" alt="Logo Bas"></div>

<div id="error"></div>

<script>
const video = document.getElementById('camera');
const errorMsg = document.getElementById('error');
const logoPreload = document.getElementById('logo-preload');

// === 1. Caméra arrière automatique ===
async function startCamera() {
  try {
    const stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: { ideal: "environment" } },
      audio: false
    });
    video.srcObject = stream;
  } catch (err) {
    errorMsg.textContent = "Erreur caméra : " + err.message;
    errorMsg.style.display = "block";
  }
}
startCamera();

// === 2. Préload logo avec zoom 3s ===
const imgLogo = new Image();
imgLogo.src = 'LogoAR.png';
imgLogo.onload = () => setTimeout(() => logoPreload.classList.add('show'), 100);

// === 3. Créer boutons après clic sur l’espace réel ===
video.addEventListener('click', () => {
  createButtons();
});

// === 4. Fonction pour créer 3 boutons interactifs ===
function createButtons() {
  const links = [
    { text: "Lien 1", url: "https://example.com/1" },
    { text: "Lien 2", url: "https://example.com/2" },
    { text: "Lien 3", url: "https://example.com/3" }
  ];

  links.forEach((link, index) => {
    const btn = document.createElement('div');
    btn.className = 'ar-button';
    btn.textContent = link.text;
    btn.style.left = `${50 + (index-1)*100}px`; // position initial
    btn.style.top = '50px';
    document.body.appendChild(btn);

    // Cliquer ouvre le lien
    btn.addEventListener('click', (e) => {
      e.stopPropagation(); // éviter de relancer l'AR
      window.open(link.url, "_blank");
    });

    // Drag tactile pour déplacer
    let offsetX=0, offsetY=0;
    btn.addEventListener('touchstart', (e)=>{
      const touch = e.touches[0];
      offsetX = touch.clientX - btn.offsetLeft;
      offsetY = touch.clientY - btn.offsetTop;
    });
    btn.addEventListener('touchmove', (e)=>{
      e.preventDefault();
      const touch = e.touches[0];
      btn.style.left = (touch.clientX - offsetX) + 'px';
      btn.style.top = (touch.clientY - offsetY) + 'px';
    });
  });
}
</script>

</body>
</html>
